<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>R for Excel Users  &middot; Gordon Shotwell</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="A website built through Hugo and blogdown." />

<meta name="keywords" content="">


<meta property="og:title" content="R for Excel Users  &middot; Gordon Shotwell ">
<meta property="og:site_name" content="Gordon Shotwell"/>
<meta property="og:url" content="/2017/02/02/r-for-excel-users/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2017-02-02T21:48:51-07:00" />
<meta property="og:article:modified_time" content="2017-02-02T21:48:51-07:00" />

  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="R for Excel Users" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/2017/02/02/r-for-excel-users/" />
<meta name="twitter:domain" content="/">
  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "R for Excel Users",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2017-02-02",
    "description": "",
    "wordCount":  3185 
  }
</script>



<link rel="canonical" href="../../../../2017/02/02/r-for-excel-users/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../touch-icon-144-precomposed.png">
<link href="../../../../favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.18.1" />

  
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../../../css/style.css">


  
  




</head>
<body>
  <main id="main-wrapper" class="container main_wrapper">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="../../../../">
  Gordon Shotwell

</a>

</div>

  
<div class="container topline">
  

</div>


</div>

  <nav class="container nav primary no-print">
  


  

</nav>

<div class="container nav secondary no-print">
  
























</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>R for Excel Users
</h1>

  <div class="metas">
<time datetime="2017-02-02">2 Feb, 2017</time>


  
  &middot; Read in about 15 min
  &middot; (3185 Words)
  <br>
  


</div>

</header>

  <div class="container content">


<div id="r-for-excel-users" class="section level1">
<h1>R for Excel Users</h1>
<p>Like most people, I first learned to work with numbers through an Excel spreadsheet. After graduating with an undergraduate philosophy degree, I somehow convinced a medical device marketing firm to pay me to write Excel reports on the orthopedic biomaterials market. When I first started I remember not knowing how to to anything, but after a few months I became fairly proficient with the tool, and was able to build all sorts of useful models. When you think about it, this is an amazing feature of Excel. Every day, all over the world people open up a spreadsheet to do some data entry and then, bit by bit, learn to do increasingly complex analytical tasks. Excel is a master at teaching people how to use excel.</p>
<p>R is not like that. I learned to use R as a side project during law school and it felt a bit like training with an abusive kung-fu master in the mountains of rural China.</p>
<div class="figure">
<img src="../../../../img/pai_mei.gif" />

</div>
<p>I couldn’t get R to do anything. It wouldn’t read in files, draw a plot or multiply two numbers together. All I could do was generate mystifying errors and get mocked on Stack Overflow for asking redundant questions. This was all made more frustrating by the fact that I could easily accomplish all of these things in Excel without much difficulty.</p>
<p>This is the basic pain of learning to program. Programming languages are designed to be general in their application and to allow you to accomplish a huge variety of complex tasks with the same basic set of tools. The cost of this generality is a steep learning curve. When you start learning to do basic tasks in R, you are also learning the skills which will allow you to accomplish very complex tasks down the road. What this means is that as you learn more and more the marginal cost of more complex analyses goes down. Excel is the opposite. Very easy at the beginning, but the marginal cost goes up with the complexity of the problem you’re working on. If you were to graph this it might look like this:</p>
<p><img src="figures/unnamed-chunk-2-1.png" width="672" /></p>
<p>At the beginning, when you are trying to accomplish simple things like balanacing a budget or entering some data by hand, R is definitely harder to learn than Excel. However, as the task gets more and more complex, it becomes easier to accomplish it in R than Excel. The reason behind this is the core structures of Excel are designed for relatively simple use cases and don’t work well best for more complex problems This isn’t to say that you can’t solve a lot of complex problems with Excel, it’s just that the tool won’t make it easy for you.</p>
<p>For a lot of us, the pain of learning to program feels like the pain of failure. When the program gives you an incromprehensible error message it feels like its telling you that you’re stupid and can’t do it. But what you learn after programming for a while, and working with other professional developers is that nobody really understands those errors, and everybody feels like an imposter when their program fails. The pain you feel is not the pain of failure, it’s just the pain of learning.</p>
<div class="figure">
<img src="../../../../img/learning_not_failing.gif" />

</div>
<div id="why-is-learning-new-things-so-hard" class="section level2">
<h2>Why is learning new things so hard?!</h2>
<p>The difficulty of learning a new tool is caused by two obstacles:</p>
<div id="obstacle-1-the-tool-is-different-from-what-you-know" class="section level4">
<h4>Obstacle #1: The tool is different from what you know</h4>
<p>When you know how to use something you have this vast amount of basic vocabulary about that tool.I haven’t used Excel seriously for six years but I can still remember all of its hotkeys, formula names, and menu structures. When youa re learning a new tool you don’t know any of this stuff which automatically makes it more difficult. Additionally, you might know where to look to find help, or how to google questions in such a way that you find useful answers. This is painful.</p>
</div>
<div id="obstacle-2-the-mental-model-underlying-the-tool-is-different-from-your-mental-model" class="section level4">
<h4>Obstacle #2: The mental model underlying the tool is different from your mental model</h4>
<p>The way the tool wants you to think about the problem is different from the way you are used to thinking about the problem. For instance, if you are used to putting your analysis in a rectangular grid, then moving to a tool which is designed around procedural commands is going to be difficult.</p>
<p>In my opinion obstacle #2 this is by far the larger barrier for Excel users. Most of the people who learn R have some basis in programming. The mental models underlying languages like Matlab or Python as well as statistical packages like SPSS and SAS have a lot in common with R, and there are a lot of resources available for translating the bits which don’t make sense. Excel makes you think about analytical problems in a very different way, and there aren’t very many resources for translating the two paradigms.</p>
</div>
</div>
<div id="four-fundamental-differences-between-r-and-excel" class="section level2">
<h2>Four Fundamental Differences Between R and Excel</h2>
<div id="text-based-analysis" class="section level4">
<h4>1) Text-based analysis</h4>
<p>Excel is based on the physical spreadsheet, or accountant’s ledger. This was a large piece of paper with rows and columns. Records were stored in the first column on the left, calculations on those records were stored in the boxes to the right, and the sum of those calculations was totaled at the bottom. I would call this a referential model of computation which has a few qualities:</p>
<ul>
<li>The data and computation are usually stored in the same place</li>
<li>Data is identified by its location on the grid. Usually you don’t name a data range in excel, but instead refer to it by its location with <code>$A1:C$36</code></li>
<li>The calculations are usually the same shape as the data. In other words if you have a list of 20 numbers which you want to multiply by 2 you have a column of 20 rows with <code>=A1 * 2, =A2 * 2, ...., =An * 2</code>.</li>
</ul>
<p>Text based data analysis is different:</p>
<ul>
<li>Data and computation are separate. You have one file which is the data and another file which is the script which tells the program how to manipulate that data. This leads to a procedural kind of model in which the raw data is fed through a set of instructions and the output pops out the other side.</li>
<li>Data is generally referenced by name. Instead of having a data set which lives in the range of <code>$A1:C$36</code> you name the data set when you read it in, and refer to it by that name whenever you want to do something with it. You can do this with Excel by naming ranges of cells, but most people don’t do this.</li>
</ul>
</div>
<div id="data-structures" class="section level4">
<h4>2) Data structures</h4>
<p>Excel has only one basic data structure: the cell. Cells are extremely flexible in that they can store numeric, character, logical or formulas information and any cell can have any of these objects.</p>
<p>The basic R data structure is a vector. You can think of a vector like a column in an Excel spreadsheet with the limitation that all the data in that vector much be of the same type. If it is a character vector, then every element must be a character, if it is a logical vector then every element must be <code>TRUE</code> or <code>FALSE</code>. There’s no such constraint in Excel, you might have a column which has a bunch of numbers, but then some explanatory test intermingled with the numbers. This isn’t allowed in R.</p>
</div>
<div id="iteration" class="section level4">
<h4>3) Iteration</h4>
<p>Iteration is one of the most powerful features of programming languages and is a big adjustment for Excel users. Iteration is just getting the computer to do the same thing over and over again for some period of time. Maybe you want to draw the same graph based on fifty different data sets, or read and filter a lot of data tables. In a programming language like R you write a script which works for all of the cases you want to apply it to, and then tell the computer to do the application.</p>
<p>Excel analysts typically do a lot of this iteration themselves. For instance if you wanted to combine ten different <code>.xls</code> files into one big file you will probably open each one individually, copy the data, and paste it into a master spreadsheet. In effect the analyst is taking the place of a <code>for</code> loop by doing one thing over and over again until a condition is met.</p>
</div>
<div id="simplification-through-abstraction" class="section level4">
<h4>4) Simplification through abstraction</h4>
<p>Another major difference is that programming encourages you to simplify your analysis by abstracting common functions from that analysis. In the example above you might find that you have to read in the same type of files over and over again and check that they have the right number of rows. R allows you to write a function which does this:</p>
<pre class="r"><code>read_and_check &lt;- function(file){
  out &lt;- read.csv(file)
  if(nrow(out) == 0) {
    stop(&quot;There&#39;s no data in this file!&quot;)
  } else {
    out
  }
}</code></pre>
<p>All this file does is read in a <code>.csv</code> file and then check to see if it has any rows, if it doesn’t it returns an error, otherwise it returns the file (which is called “out”). This is a powerful approach because it helps you save time and reduce errors. For instance if you want to check if the file has more than 23 rows, you only have to change the condition in one place.</p>
<p>There’s really no analog in an Excel-based workflow, and when most analysts get to this point they just start writing VBA code to do some of this work.</p>
</div>
<div id="example-joining-two-tables-together" class="section level3">
<h3>Example: Joining two tables together</h3>
<p>I thought I’d illustrate these principles by working through the example of joining two tables together in Excel and R. Let’s say that we had two data tables, one with some information about cars and another with the colour of those cars, and we want to join the two of them together. For the purpose of this exercise we’re going to assume that the number of cylinders in a car determines it’s colour.</p>
<pre class="r"><code>library(dplyr)
library(knitr)
cars &lt;- mtcars
colours &lt;- data_frame(
  cyl = unique(cars$cyl),
  colour = c(&quot;Blue&quot;, &quot;Green&quot;, &quot;Eggplant&quot;)
)

kable(cars) #kable is just for displaying the table</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Merc 280C</td>
<td align="right">17.8</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 450SE</td>
<td align="right">16.4</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">4.070</td>
<td align="right">17.40</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>Merc 450SL</td>
<td align="right">17.3</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.730</td>
<td align="right">17.60</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>Merc 450SLC</td>
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.780</td>
<td align="right">18.00</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>Cadillac Fleetwood</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">472.0</td>
<td align="right">205</td>
<td align="right">2.93</td>
<td align="right">5.250</td>
<td align="right">17.98</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Lincoln Continental</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">460.0</td>
<td align="right">215</td>
<td align="right">3.00</td>
<td align="right">5.424</td>
<td align="right">17.82</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Chrysler Imperial</td>
<td align="right">14.7</td>
<td align="right">8</td>
<td align="right">440.0</td>
<td align="right">230</td>
<td align="right">3.23</td>
<td align="right">5.345</td>
<td align="right">17.42</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Fiat 128</td>
<td align="right">32.4</td>
<td align="right">4</td>
<td align="right">78.7</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">2.200</td>
<td align="right">19.47</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Honda Civic</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">75.7</td>
<td align="right">52</td>
<td align="right">4.93</td>
<td align="right">1.615</td>
<td align="right">18.52</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Toyota Corolla</td>
<td align="right">33.9</td>
<td align="right">4</td>
<td align="right">71.1</td>
<td align="right">65</td>
<td align="right">4.22</td>
<td align="right">1.835</td>
<td align="right">19.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Toyota Corona</td>
<td align="right">21.5</td>
<td align="right">4</td>
<td align="right">120.1</td>
<td align="right">97</td>
<td align="right">3.70</td>
<td align="right">2.465</td>
<td align="right">20.01</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Dodge Challenger</td>
<td align="right">15.5</td>
<td align="right">8</td>
<td align="right">318.0</td>
<td align="right">150</td>
<td align="right">2.76</td>
<td align="right">3.520</td>
<td align="right">16.87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>AMC Javelin</td>
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">304.0</td>
<td align="right">150</td>
<td align="right">3.15</td>
<td align="right">3.435</td>
<td align="right">17.30</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Camaro Z28</td>
<td align="right">13.3</td>
<td align="right">8</td>
<td align="right">350.0</td>
<td align="right">245</td>
<td align="right">3.73</td>
<td align="right">3.840</td>
<td align="right">15.41</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Pontiac Firebird</td>
<td align="right">19.2</td>
<td align="right">8</td>
<td align="right">400.0</td>
<td align="right">175</td>
<td align="right">3.08</td>
<td align="right">3.845</td>
<td align="right">17.05</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Fiat X1-9</td>
<td align="right">27.3</td>
<td align="right">4</td>
<td align="right">79.0</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">1.935</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Porsche 914-2</td>
<td align="right">26.0</td>
<td align="right">4</td>
<td align="right">120.3</td>
<td align="right">91</td>
<td align="right">4.43</td>
<td align="right">2.140</td>
<td align="right">16.70</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Lotus Europa</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">95.1</td>
<td align="right">113</td>
<td align="right">3.77</td>
<td align="right">1.513</td>
<td align="right">16.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Ford Pantera L</td>
<td align="right">15.8</td>
<td align="right">8</td>
<td align="right">351.0</td>
<td align="right">264</td>
<td align="right">4.22</td>
<td align="right">3.170</td>
<td align="right">14.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Ferrari Dino</td>
<td align="right">19.7</td>
<td align="right">6</td>
<td align="right">145.0</td>
<td align="right">175</td>
<td align="right">3.62</td>
<td align="right">2.770</td>
<td align="right">15.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td>Maserati Bora</td>
<td align="right">15.0</td>
<td align="right">8</td>
<td align="right">301.0</td>
<td align="right">335</td>
<td align="right">3.54</td>
<td align="right">3.570</td>
<td align="right">14.60</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td>Volvo 142E</td>
<td align="right">21.4</td>
<td align="right">4</td>
<td align="right">121.0</td>
<td align="right">109</td>
<td align="right">4.11</td>
<td align="right">2.780</td>
<td align="right">18.60</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kable(colours)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">cyl</th>
<th align="left">colour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">6</td>
<td align="left">Blue</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="left">Eggplant</td>
</tr>
</tbody>
</table>
<p>In Excel you would probably do this using the <code>VLOOKUP()</code> function, which takes a key, and a range, and then looks up the value of that key within that range. I put together an example spreadsheet of this approach <a href="https://docs.google.com/spreadsheets/d/1K2IqdXX2MoUB4BorRcBcruS7spCvRtDwqXV-4gYAob4/edit?usp=sharing">here</a>. Notice that in each cell that I want to lookup I typed some version of <code>=vlookup(C4,$H$2:$I$5, 2, FALSE)</code> This illustrates a few things. First the calculation is the same shape as the data, and happens in the same file as the data. We have as many formulas as we have things that we want to lookup, and they are placed right next to the dataset. Second, the data is refered to by its address on the sheet. If we move the lookup table to another sheet, or another place on this sheet that is going to screw up out lookup. Third, notice that the first entry of the <code>cyl</code> column in the spreadsheet store in <code>C2</code> is stored as text, while the rest are all nuemric which causes an error in the lookup function. In R you would have to store all the cylendar values as a numeric or character vector.</p>
<p>To do the same thing in R we would use this code:</p>
<pre class="r"><code>left_join(cars, colours, by = &quot;cyl&quot;) %&gt;% 
  kable() </code></pre>
<table>
<thead>
<tr class="header">
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
<th align="left">colour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">Blue</td>
</tr>
<tr class="even">
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">Blue</td>
</tr>
<tr class="odd">
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">Green</td>
</tr>
<tr class="even">
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">Blue</td>
</tr>
<tr class="odd">
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">Blue</td>
</tr>
<tr class="odd">
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
<tr class="even">
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">Blue</td>
</tr>
<tr class="odd">
<td align="right">17.8</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">Blue</td>
</tr>
<tr class="even">
<td align="right">16.4</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">4.070</td>
<td align="right">17.40</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">Eggplant</td>
</tr>
<tr class="odd">
<td align="right">17.3</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.730</td>
<td align="right">17.60</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.780</td>
<td align="right">18.00</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">Eggplant</td>
</tr>
<tr class="odd">
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">472.0</td>
<td align="right">205</td>
<td align="right">2.93</td>
<td align="right">5.250</td>
<td align="right">17.98</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">460.0</td>
<td align="right">215</td>
<td align="right">3.00</td>
<td align="right">5.424</td>
<td align="right">17.82</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="odd">
<td align="right">14.7</td>
<td align="right">8</td>
<td align="right">440.0</td>
<td align="right">230</td>
<td align="right">3.23</td>
<td align="right">5.345</td>
<td align="right">17.42</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">32.4</td>
<td align="right">4</td>
<td align="right">78.7</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">2.200</td>
<td align="right">19.47</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">75.7</td>
<td align="right">52</td>
<td align="right">4.93</td>
<td align="right">1.615</td>
<td align="right">18.52</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
<tr class="even">
<td align="right">33.9</td>
<td align="right">4</td>
<td align="right">71.1</td>
<td align="right">65</td>
<td align="right">4.22</td>
<td align="right">1.835</td>
<td align="right">19.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">21.5</td>
<td align="right">4</td>
<td align="right">120.1</td>
<td align="right">97</td>
<td align="right">3.70</td>
<td align="right">2.465</td>
<td align="right">20.01</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">Green</td>
</tr>
<tr class="even">
<td align="right">15.5</td>
<td align="right">8</td>
<td align="right">318.0</td>
<td align="right">150</td>
<td align="right">2.76</td>
<td align="right">3.520</td>
<td align="right">16.87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">Eggplant</td>
</tr>
<tr class="odd">
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">304.0</td>
<td align="right">150</td>
<td align="right">3.15</td>
<td align="right">3.435</td>
<td align="right">17.30</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">13.3</td>
<td align="right">8</td>
<td align="right">350.0</td>
<td align="right">245</td>
<td align="right">3.73</td>
<td align="right">3.840</td>
<td align="right">15.41</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="odd">
<td align="right">19.2</td>
<td align="right">8</td>
<td align="right">400.0</td>
<td align="right">175</td>
<td align="right">3.08</td>
<td align="right">3.845</td>
<td align="right">17.05</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">27.3</td>
<td align="right">4</td>
<td align="right">79.0</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">1.935</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">26.0</td>
<td align="right">4</td>
<td align="right">120.3</td>
<td align="right">91</td>
<td align="right">4.43</td>
<td align="right">2.140</td>
<td align="right">16.70</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
<tr class="even">
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">95.1</td>
<td align="right">113</td>
<td align="right">3.77</td>
<td align="right">1.513</td>
<td align="right">16.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
<tr class="odd">
<td align="right">15.8</td>
<td align="right">8</td>
<td align="right">351.0</td>
<td align="right">264</td>
<td align="right">4.22</td>
<td align="right">3.170</td>
<td align="right">14.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">19.7</td>
<td align="right">6</td>
<td align="right">145.0</td>
<td align="right">175</td>
<td align="right">3.62</td>
<td align="right">2.770</td>
<td align="right">15.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">Blue</td>
</tr>
<tr class="odd">
<td align="right">15.0</td>
<td align="right">8</td>
<td align="right">301.0</td>
<td align="right">335</td>
<td align="right">3.54</td>
<td align="right">3.570</td>
<td align="right">14.60</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="left">Eggplant</td>
</tr>
<tr class="even">
<td align="right">21.4</td>
<td align="right">4</td>
<td align="right">121.0</td>
<td align="right">109</td>
<td align="right">4.11</td>
<td align="right">2.780</td>
<td align="right">18.60</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="left">Green</td>
</tr>
</tbody>
</table>
<p>Here we refer to the data by its name, use one function to operate on the whole table rather than row by row, and because consistency is enforced for each vector there’s no character in the first place.</p>
</div>
<div id="iteration-1" class="section level3">
<h3>Iteration</h3>
<p>Now let’s say we wanted to get the mean displacement for each colour of car. Most Excel users would probably do this iteration mannually, first selecting the table and sorting it by colour and then picking out the ranges that they wanted to average. A more sophisticated analyst would probably use the <code>averageif()</code> function to pick out the criteria they wanted to average on, and so avoid a few errors. Both approaches are implemented in the <a href="https://docs.google.com/spreadsheets/d/1K2IqdXX2MoUB4BorRcBcruS7spCvRtDwqXV-4gYAob4/edit#gid=364351786">iteration</a> tab of the spreadsheet.</p>
<p>In R you would do something like this:</p>
<pre class="r"><code>left_join(cars, colours, by = &quot;cyl&quot;) %&gt;% 
  group_by(colour) %&gt;% 
  summarize(mean_displacement = mean(disp)) %&gt;% 
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">colour</th>
<th align="right">mean_displacement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Blue</td>
<td align="right">183.3143</td>
</tr>
<tr class="even">
<td align="left">Eggplant</td>
<td align="right">353.1000</td>
</tr>
<tr class="odd">
<td align="left">Green</td>
<td align="right">105.1364</td>
</tr>
</tbody>
</table>
<p>What this does is takes the data set, splits it up by the grouping variable, in this case colour, then applies the function in the <code>summarize</code> function to each group. Again, the difference is that we’re always refering to things by name rather than location, there is one line of code which applies to each group, and all of the iterative actions are stored in the script.</p>
</div>
<div id="generalizing-through-functions" class="section level3">
<h3>Generalizing through functions</h3>
<p>Functions are among the more difficult parts of learning to program, and you really can get by for quite a long time without ever learning to use them. I wanted to include them just because they are commonly used and can be quite discouraging for Excel users because they are totally foreign to the excel workflow. A function is a way of using existing code on new objects. In the case above it might look like this:</p>
<pre class="r"><code>join_and_summarize &lt;- function(df, colour_df){
  left_join(df, colour_df, by = &quot;cyl&quot;) %&gt;% 
    group_by(colour) %&gt;% 
    summarize(mean_displacement = mean(disp))
}</code></pre>
<p>The things between the <code>function()</code> braces are called “arguments”, and when you call the function all it does is take the actual objects you supply to the funciton and plugs them in to wherever that argument appears between the curly braces. In this case we would supply <code>cars</code> in the <code>df</code> argument, and it would just replace all the <code>df</code>’s it can find with the <code>cars</code> object and all the <code>could_df</code>’s with the <code>colours</code> object.</p>
<pre class="r"><code>join_and_summarize(cars, colours) %&gt;% 
  kable() </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">colour</th>
<th align="right">mean_displacement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Blue</td>
<td align="right">183.3143</td>
</tr>
<tr class="even">
<td align="left">Eggplant</td>
<td align="right">353.1000</td>
</tr>
<tr class="odd">
<td align="left">Green</td>
<td align="right">105.1364</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>Excel users have a strong mental model of how data analysis works, and this makes learning to program more difficult. However, learning to program will allow you to do things that you can’t do easily in Excel, and it really is worth the pain of learning the new model.</p>
<div class="figure">
<img src="../../../../img/pai_mei_silloutette.gif" />

</div>
</div>
</div>
</div>



</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  


</div>

  <div class="container comments">
  <h2>Comments</h2>
  

</div>

</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  

</div>


  

</div>

</footer>

    </main>
    



    
  </body>
</html>

