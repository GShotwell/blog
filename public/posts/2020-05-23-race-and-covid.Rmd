---
title: "Treatable causes of Covid-19 mortality"
author: "Gordon Shotwell"
date: "2020-05-23"
draft: true
output: html_document
---
```{r, include = FALSE}
library(tidyverse)
library(DiagrammeR)
```

I got into a Twitter argument a few weeks ago about vitamin D and Covid, where I suggested that part of the explanation for why people of colour were dying at a high rate in Northern latitudes was due to low vitamin D.
The person I was interacting with took this as basically a racist statement because it undermined the major determinants of health for black people, like preexisting environmental conditions, and racist allocation of health care resources.
This isn't what I meant, but I don't think it's an unreasonable conclusion to jump to -- after all, I'm a white man with a Github repo, and sadly many white men with Github repos provide simplistic and essentialist explanations of racial difference. 
My own perspective is that in the American context, it's basically impossible to overrate slavery as an explanation for why the country is the way it is.
Slavery is why the country has an electoral college, it's why the senate exists, and it's at the core of almost all of the major political turning points of the twentieth century.
That said, I think it's a mistake to assume that legacies of slavery and colonialism are complete accounts of racial health outcomes, because while those causes are almost certainly the most important, they're also the hardest to change.

# The Villarosa model

There was a [wonderful interview](https://www.nytimes.com/2020/05/20/podcasts/the-daily/black-death-rate-coronavirus.html) with Linda Villarosa about excess African American Covid mortality.
In it she outlines the three major causes that she and other public health researchers identified as causes for the huge racial gap in Covid mortality. 

### 1) Proximity to the virus
Black people live and work in environments where the virus is difficult to escape. 
They are more likely to work in essential services where it is difficult to engage in social distancing, and they are more likely to live in inter-generational homes in densely populated areas.
All of this leads to more contact with the virus, more contact leads to more infection, and more infection leads to more death

### 2) Racial bias in health care
Black people receive worse health care than white people.
Black patients are less likely to be believed by physicians, essential interventions are more likely to be delayed,
and resources tend to be allocated to white patients. 
Naturally, if you get worse health care because of your skin colour, your outcomes are going to be worse.

### 3) Pre-existing conditions
For a variety of reasons, Black Americans have higher rates of conditions which make Covid-19 more dangerous. 
Rates of diabetes, hypertension, and asthma are all higher in Black communities, 
which leads to higher Covid-19 mortality.

It's helpful to draw this model as a graph to show the causal relationship. 


```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
  graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  A [label = 'Proximity to the virus']; 
  B [label = 'Pre-existing conditions']; 
  C [label = 'Health care bias']; 
  D [label = 'Excess Covid mortality']

  # several 'edge' statements
  A->D B->D C->D 
  S->A S->B S->C
}
")
```

# The vitamin D model

When I was suggesting that Vitamin D might be a part of the story, I think the person I was interacting with thought that I meant it was the whole story. 
In other words I was arguing for a model like this which didn't include any social determinants of health:

```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
    graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  V [label = 'Low vitamin D']
  D [label = 'Excess Covid mortality']

  # several 'edge' statements
  V ->D S ->V
}
")
```

Again, given how white male programmers behave on Twitter, this isn't an unreasonable thing to think, but neither myself nor any actual vitamin D scientists are suggesting that model.

Instead the vitamin D model looks like this:

```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
  graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  A [label = 'Proximity to virus'] 
  B [label = 'Pre-existing conditions'] 
  C [label = 'Health care bias']
  V [label = 'Low vitamin D']
  D [label = 'Excess Covid mortality']

  # several 'edge' statements
  A->D B->D C->D V->D
  S->A S->B S->C S->V
}
")
```

The reason I think this model is important is that if there is a connection between vitamin D deficiency and Covid-19 mortality, then that's a factor that's easy to treat.
The depressing thing about social determinants of health is that it's hard or impossible to change them in time frame that they need to be changed to meaningfully change Covid mortality.
For example if someone has diabetes, we can't change that over the next year. 
Similarly, it's unlikely that we're going to be able to make major changes to our housing or economy such that Black people are not disproportionately proximate to the virus. 
It's possible that bias in health care can be remedied, but that would require major changes on the part of medical systems that so far have been pretty unwilling to take,

Vitamin D by contrast is pretty easy to change. 
It's a cheap, safe therapy, that doesn't require big systemic change.
So if it were a factor in Covid mortality, even a small one, that's worth knowing because it a factor we can modify.
So while I don't think that vitamin D is the biggest factor causing excess mortality, I do think it's an exciting treatment candidate.

# What does the data say

Of course none of this matters if it turns out that vitamin D is not a factor. 
So far there have been two main strategies which point in the direction that vitamin D, or some other unidentified factor which varies by latitude, are involved in Covid-19 mortality. 

## Controlling for social determinants of health
The main strategy statisticians use to identify whether a factor is important is to control for confounding factors. 
For instance, someone might suggest that race determines SAT scores by looking at some data and seeing that there's a correlation between race and SAT scores.
We might respond to this claim by pointing out that different racial groups live in different neighborhoods, and go to different schools, and this probably changes how prepared people are for the test.
If you control for those factors you tend to find that race provides no real information about SAT scores because it's a proxy for which school you go to. 

By contrast when you do same exercise about arrest decisions you probably would find that race is an independent factor.
Even you account for neighborhood, crime, or time of day you still find that race is an important predictor of arrest because police, consciously or not, tend to arrest people of colour more often.

There are two main studies that have attempted to control for social determinants of health when explaining Covid-19 outcomes:

First, a [study out out the UK](https://www.medrxiv.org/content/10.1101/2020.05.06.20092999v1.full.pdf) looked at NHS records and Covid-19 mortality. 
They controlled for preexisting conditions as well a [deprivation index](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/833959/IoD2019_Infographic.pdf) which combines income, employment, premature death, education, crime, barriers to housing, and living environment.
What they found is that after controlling for all of these things race was still a significant predictor of Covid-19 mortality, with Black, Asian, and mixed race people having about a two-fold higher risk of death as compared to white people.

This study confirms two out of the three causal pieces of Villarosa's model of Covid mortality. 
The deprivation index, which captures at least some of the socioeconomic factors which lead people to be more proximate, was associated with increased mortality,
and preexisting conditions were also found to lead to increased mortality.

The second study is a [study of US veterans](https://www.medrxiv.org/content/10.1101/2020.05.12.20099135v1) which found that "Black and Hispanic individuals are experiencing an excess burden of Covid-19 not entirely explained by underlying medical conditions or where they live or receive care." 
This study controlled for age, pre-existing condition and whether someone lived in an urban or rural setting, and the main outcome was a positive diagnosis. 
They found that Black veterans were more likely to be tested than white veterans,
but were about twice as likely to test positive.

This study also controls for two pieces of Villarosa's model. 
It directly controls for pre-existing conditions, but also is a kind of implicit control on caregiver bias because the main outcome was a positive test.
Logically, caregiver bias is more important the more treatment decisions a caregiver has to make. 
Giving birth is a great example, a doctor needs to decide whether to admit someone who might have a dangerous pregnancy, whether to induce, how to monitor fetal heart rate, and at what point to intervene with an emergency C-section. 
Bias creeps in at all of these points, doctor's might send a Black woman home when they would admit a white women, monitor fetal heart rate less carefully, or intervene in dangerous labour a few minutes later. 
Each of these biased decisions endangers mother and child, and it's a big part of why there's a big racial gap in infant mortality. 

By contrast, Covid diagnosis really only involves the one decision of whether to test or not, and racial bias would tend to lead to under test Black people. 
A doctor might do a Covid-19 test on a white patient with marginal symptoms, while they may send a Black patient home without a test. 
So bias in this case would reinforce, rather than undermine the finding that Black and Hispanic people are at a higher risk of Covid-19. 

Neither of the studies above perfectly control for the features in Villarosa's model. 
It's possible that the missing piece in the NHS model was biased medical care, and the missing piece  in the VA model was proximity to the virus, but it should at least make you suspicious that there's an important factor which isn't being accounted for in the standard way of thinking about racial gaps in health outcome.

## Mendelian Randomization

A [recent study](https://nutrition.bmj.com/content/early/2020/05/20/bmjnph-2020-000096) in the BMJ provides a strong argument that that missing factor is vitamin D. 
The study uses a technique called mendelian randomisation which requires a bit of explanation.
In the ideal world, we would answer the question of whether vitamin D deficiency increases your risk of dying of Covid by controlling for vitamin D in the model, but we don't have that information. 
However, if you have information about something which you know is related to vitamin D status, then you can include that as a proxy. 
In the case we know that people with darker skin tend to have lower vitamin D levels than people with lighter skin, and that that gets worse as you move north. 
In places like Florida where there's abundant sun, it doesn't really matter how efficient your skin is at making vitamin D because it's sunny for of the year. 
In places like Wisconsin where you don't get much sun in the winter, and the UV intensity is too low for your skin to use, the gap gets bigger.

The rules of mendelian randomization are that randomizing factor can't be directly associated with the outcome, and it can't be associated with other explanatory factors. 

So if you think the causal graph looks like this, mendelian randomization is appropriate:

```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
  graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  A [label = 'Social determinants of health'] 
  V [label = 'Low vitamin D']
  D [label = 'Excess Covid mortality']
  L [label = 'Northern Latitude']

  # several 'edge' statements
  A->D  V->D
  S->A S->V
  L->V
}
")
```

This study found that excess mortality went up as you went North, and went up by a lot.
Places like Alabama which we typically think of as having bad racial health outcomes, had lower excess Covid mortality than places like Wisconsin. 
This is a very strong argument for vitamin D's involvement, because it's hard to find a story where latitude modifies other inputs into the Covid mortality. 
This isn't to say that there's no such story, but the most obvious one is that vitamin D deficiency increases risk of Covid-19 complication.

![](/img/excess_aa_mortality.jpg)


### Does latitude change modify SDH?

Mendelian randomization is not appropriate if the proxy also acts on your other predictor variables.
For instance you might think that because there are fewer Black people in Wisconsin than Atalanta, there are also fewer Black doctors, and so implicit racial bias might be worse. 
If that were the case latitude wouldn't give you much information about vitamin D, because it could also be acting on the other social determinants of health. 
The causal graph would look like this :

```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
  graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  A [label = 'Social determinants of health'] 
  V [label = 'Low vitamin D']
  D [label = 'Excess Covid mortality']
  L [label = 'Northern Latitude']

  # several 'edge' statements
  A->D  V->D
  S->A S->V
  L->V L->A
}
")
```

One quick check we can do to see if this graph makes sense is to look at infant mortality data by latitude. 
If excess infant mortality was a lot higher in Northern states than Southern ones, that would suggest that mendelian randomization wasn't appropriate in this case.
The data from the CDC is really depressing and shows that infant mortality among African Americans is 2-3 times higher than among white people in just about every state.
However, there doesn't seem to be a strong association with latitude. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
april_16 <- readr::read_csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_daily_reports_us/04-16-2020.csv")
births <- readr::read_tsv("us_infant_mortality.txt")

infant_mortality <- births %>% 
  janitor::clean_names() %>% 
  select(state, mothers_bridged_race, death_rate) %>% 
  mutate(death_rate = as.numeric(death_rate)) %>%
  tidyr::pivot_wider(names_from = mothers_bridged_race,
                     values_from = death_rate) %>% 
  janitor::clean_names() %>% 
  mutate(infant_mortality_risk = black_or_african_american / white) %>% 
  select(state, infant_mortality_risk)

april_16 %>% 
  left_join(infant_mortality, by = c("Province_State" = "state")) %>% 
  filter(!is.na(infant_mortality_risk)) %>% 
  ggplot(aes(x = Lat, y = infant_mortality_risk)) +
  geom_point() +
  theme_minimal() +
  labs(title = "US infant mortality risk",
       subtitle = "CDC data",
       y = "Excess infant mortality (fold)",
       x = "Latitude")
```

### Does latitude act directly on mortality
The other way that mendelian randomization can be invalid is if the proxy acts directly on the outcome variable. 
In this case that would mean that latitude directly increased excess Covid mortality. 
At first glance it's hard to think of how this would happen, but if you add testing to the model it becomes a bit clearer. 
If Southern states have worse testing, and in particular are less likely to test Black people, Covid deaths would be misclassified as some other kind of mortality. 
The result would be that excess mortality would *look* lower, because Covid deaths among Black people were being under counted.

The graph would look like this:
```{r, echo = FALSE}
grViz("
digraph boxes_and_circles {
  graph [overlap = true, fontsize = 10,
         rankdir = LR]
  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  S [label = 'Person of colour']
  A [label = 'Social determinants of health'] 
  V [label = 'Low vitamin D']
  T [label = 'Better testing']
  D [label = 'Excess Covid mortality']
  L [label = 'Northern Latitude']

  # several 'edge' statements
  A->D  V->D
  S->A S->V
  L->V 
  L->T T->D
}
")
```

I don't have access to any data that shows testing by race and state, but we can look at the overall testing rate to see if that varies by latitude.
The intuition here is that in places with abundant testing, racial bias would be less of a factor than in the places with scarce testing. 
Again there doesn't look to be much of a relationship here.

```{r message=FALSE, echo = FALSE}
april_16 %>% 
  dplyr::filter(Deaths > 15) %>% 
ggplot(aes(x = Lat, y = Testing_Rate))+
  geom_point() +
  theme_minimal() +
  labs(
    y = "Tests per 100,000",
    x = "Latitude",
    title = "US Testing Rate by Latitude",
    subtitle = "States with more than 15 deaths on April 15th"
  ) 
```

# Conclusion
To reiterate, this is not to dispute the factors that Villarosa proposes.
None of the papers about vitamin D and Covid challenge the idea that health care bias, pre-existing conditions, and proximity to the virus are major causes of excess mortality, and in fact all of the data supports that conclusion. 
What this does challenge is the idea that that's the whole story, it seems like excess Covid mortality among people with darker skin is not completely explained by socioeconomics, location, or pre-existing medical condition.
Vitamin D is a good candidate for that missing piece because it helps to explain why latitude would increase the racial gap in Covid mortality. 










